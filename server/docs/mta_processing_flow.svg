<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Title: mta_processing_flow Pages: 1 -->
<svg width="1143pt" height="744pt"
 viewBox="0.00 0.00 1143.00 744.16" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 740.16)">
<title>mta_processing_flow</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-740.16 1139,-740.16 1139,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_stages</title>
<polygon fill="lightcyan" stroke="black" points="8,-233.16 8,-310.16 578.5,-310.16 578.5,-233.16 8,-233.16"/>
<text text-anchor="middle" x="293.25" y="-292.86" font-family="Times,serif" font-size="14.00">MTA Hook Stages</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_tables</title>
<polygon fill="lightblue" stroke="black" points="806,-68.16 806,-535.16 1127,-535.16 1127,-68.16 806,-68.16"/>
<text text-anchor="middle" x="966.5" y="-517.86" font-family="Times,serif" font-size="14.00">Database Tables</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_logic</title>
<polygon fill="lightyellow" stroke="black" points="498.25,-318.16 498.25,-557.16 734.25,-557.16 734.25,-318.16 498.25,-318.16"/>
<text text-anchor="middle" x="616.25" y="-539.86" font-family="Times,serif" font-size="14.00">Processing Logic</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_actions</title>
<polygon fill="lightpink" stroke="black" points="807.74,-543.16 807.74,-728.16 923.26,-728.16 923.26,-543.16 807.74,-543.16"/>
<text text-anchor="middle" x="865.5" y="-710.86" font-family="Times,serif" font-size="14.00">Possible Actions</text>
</g>
<!-- connect -->
<g id="node1" class="node">
<title>connect</title>
<polygon fill="none" stroke="black" points="82.25,-277.16 16,-277.16 16,-241.16 82.25,-241.16 82.25,-277.16"/>
<text text-anchor="middle" x="49.12" y="-261.66" font-family="Arial" font-size="10.00">CONNECT</text>
<text text-anchor="middle" x="49.12" y="-249.66" font-family="Arial" font-size="10.00">Stage</text>
</g>
<!-- ehlo -->
<g id="node2" class="node">
<title>ehlo</title>
<polygon fill="none" stroke="black" points="173.25,-277.16 119.25,-277.16 119.25,-241.16 173.25,-241.16 173.25,-277.16"/>
<text text-anchor="middle" x="146.25" y="-261.66" font-family="Arial" font-size="10.00">EHLO</text>
<text text-anchor="middle" x="146.25" y="-249.66" font-family="Arial" font-size="10.00">Stage</text>
</g>
<!-- connect&#45;&gt;ehlo -->
<g id="edge1" class="edge">
<title>connect&#45;&gt;ehlo</title>
<path fill="none" stroke="black" d="M82.6,-259.16C90.64,-259.16 99.33,-259.16 107.61,-259.16"/>
<polygon fill="black" stroke="black" points="107.4,-262.66 117.4,-259.16 107.4,-255.66 107.4,-262.66"/>
</g>
<!-- ip_check -->
<g id="node12" class="node">
<title>ip_check</title>
<polygon fill="none" stroke="black" points="576.62,-524.16 510.38,-524.16 510.38,-488.16 576.62,-488.16 576.62,-524.16"/>
<text text-anchor="middle" x="543.5" y="-508.66" font-family="Arial" font-size="10.00">IP Blocking</text>
<text text-anchor="middle" x="543.5" y="-496.66" font-family="Arial" font-size="10.00">Check</text>
</g>
<!-- connect&#45;&gt;ip_check -->
<g id="edge6" class="edge">
<title>connect&#45;&gt;ip_check</title>
<path fill="none" stroke="black" d="M53.22,-277.28C63.3,-333.32 97.34,-500.16 145.25,-500.16 145.25,-500.16 145.25,-500.16 443.25,-500.16 461.34,-500.16 481.26,-501.17 498.47,-502.36"/>
<polygon fill="black" stroke="black" points="498.16,-505.84 508.39,-503.09 498.67,-498.86 498.16,-505.84"/>
</g>
<!-- mail -->
<g id="node3" class="node">
<title>mail</title>
<polygon fill="none" stroke="black" points="281.75,-277.16 210.25,-277.16 210.25,-241.16 281.75,-241.16 281.75,-277.16"/>
<text text-anchor="middle" x="246" y="-261.66" font-family="Arial" font-size="10.00">MAIL FROM</text>
<text text-anchor="middle" x="246" y="-249.66" font-family="Arial" font-size="10.00">Stage</text>
</g>
<!-- ehlo&#45;&gt;mail -->
<g id="edge2" class="edge">
<title>ehlo&#45;&gt;mail</title>
<path fill="none" stroke="black" d="M173.7,-259.16C181.4,-259.16 190.04,-259.16 198.59,-259.16"/>
<polygon fill="black" stroke="black" points="198.56,-262.66 208.56,-259.16 198.56,-255.66 198.56,-262.66"/>
</g>
<!-- email_validation -->
<g id="node13" class="node">
<title>email_validation</title>
<polygon fill="none" stroke="black" points="580.75,-470.16 506.25,-470.16 506.25,-434.16 580.75,-434.16 580.75,-470.16"/>
<text text-anchor="middle" x="543.5" y="-454.66" font-family="Arial" font-size="10.00">Email Format</text>
<text text-anchor="middle" x="543.5" y="-442.66" font-family="Arial" font-size="10.00">Validation</text>
</g>
<!-- ehlo&#45;&gt;email_validation -->
<g id="edge9" class="edge">
<title>ehlo&#45;&gt;email_validation</title>
<path fill="none" stroke="black" d="M149.69,-277.52C156.4,-319.54 179.25,-419.16 245,-419.16 245,-419.16 245,-419.16 443.25,-419.16 460.66,-419.16 478.95,-423.79 495.02,-429.58"/>
<polygon fill="black" stroke="black" points="493.75,-432.84 504.34,-433.19 496.28,-426.31 493.75,-432.84"/>
</g>
<!-- rcpt -->
<g id="node4" class="node">
<title>rcpt</title>
<polygon fill="none" stroke="black" points="378.25,-277.16 318.75,-277.16 318.75,-241.16 378.25,-241.16 378.25,-277.16"/>
<text text-anchor="middle" x="348.5" y="-261.66" font-family="Arial" font-size="10.00">RCPT TO</text>
<text text-anchor="middle" x="348.5" y="-249.66" font-family="Arial" font-size="10.00">Stage</text>
</g>
<!-- mail&#45;&gt;rcpt -->
<g id="edge3" class="edge">
<title>mail&#45;&gt;rcpt</title>
<path fill="none" stroke="black" d="M282.15,-259.16C290.23,-259.16 298.88,-259.16 307.16,-259.16"/>
<polygon fill="black" stroke="black" points="307.01,-262.66 317.01,-259.16 307.01,-255.66 307.01,-262.66"/>
</g>
<!-- mail&#45;&gt;email_validation -->
<g id="edge11" class="edge">
<title>mail&#45;&gt;email_validation</title>
<path fill="none" stroke="black" d="M281.94,-272.82C332.97,-294.27 428.33,-340.21 488.25,-405.16 494.99,-412.47 491.52,-417.85 498.25,-425.16 498.71,-425.66 499.17,-426.15 499.65,-426.64"/>
<polygon fill="black" stroke="black" points="497.12,-429.07 506.98,-432.96 501.7,-423.78 497.12,-429.07"/>
</g>
<!-- data -->
<g id="node5" class="node">
<title>data</title>
<polygon fill="none" stroke="black" points="469.25,-277.16 415.25,-277.16 415.25,-241.16 469.25,-241.16 469.25,-277.16"/>
<text text-anchor="middle" x="442.25" y="-261.66" font-family="Arial" font-size="10.00">DATA</text>
<text text-anchor="middle" x="442.25" y="-249.66" font-family="Arial" font-size="10.00">Stage</text>
</g>
<!-- rcpt&#45;&gt;data -->
<g id="edge4" class="edge">
<title>rcpt&#45;&gt;data</title>
<path fill="none" stroke="black" d="M378.53,-259.16C386.45,-259.16 395.15,-259.16 403.48,-259.16"/>
<polygon fill="black" stroke="black" points="403.38,-262.66 413.38,-259.16 403.38,-255.66 403.38,-262.66"/>
</g>
<!-- category_check -->
<g id="node14" class="node">
<title>category_check</title>
<polygon fill="none" stroke="black" points="572.5,-416.16 514.5,-416.16 514.5,-380.16 572.5,-380.16 572.5,-416.16"/>
<text text-anchor="middle" x="543.5" y="-400.66" font-family="Arial" font-size="10.00">Category</text>
<text text-anchor="middle" x="543.5" y="-388.66" font-family="Arial" font-size="10.00">Validation</text>
</g>
<!-- rcpt&#45;&gt;category_check -->
<g id="edge12" class="edge">
<title>rcpt&#45;&gt;category_check</title>
<path fill="none" stroke="black" d="M375.88,-277.62C404.22,-297.7 450.29,-331.1 488.25,-362.16 492.88,-365.95 493.46,-367.59 498.25,-371.16 500.38,-372.75 502.61,-374.33 504.88,-375.89"/>
<polygon fill="black" stroke="black" points="502.81,-378.71 513.1,-381.25 506.64,-372.85 502.81,-378.71"/>
</g>
<!-- auth -->
<g id="node6" class="node">
<title>auth</title>
<polygon fill="none" stroke="black" points="570.5,-277.16 516.5,-277.16 516.5,-241.16 570.5,-241.16 570.5,-277.16"/>
<text text-anchor="middle" x="543.5" y="-261.66" font-family="Arial" font-size="10.00">AUTH</text>
<text text-anchor="middle" x="543.5" y="-249.66" font-family="Arial" font-size="10.00">Stage</text>
</g>
<!-- data&#45;&gt;auth -->
<g id="edge5" class="edge">
<title>data&#45;&gt;auth</title>
<path fill="none" stroke="black" d="M469.59,-259.16C480.35,-259.16 493.01,-259.16 504.74,-259.16"/>
<polygon fill="black" stroke="black" points="504.53,-262.66 514.53,-259.16 504.53,-255.66 504.53,-262.66"/>
</g>
<!-- subscription_check -->
<g id="node15" class="node">
<title>subscription_check</title>
<polygon fill="none" stroke="black" points="578.5,-362.16 508.5,-362.16 508.5,-326.16 578.5,-326.16 578.5,-362.16"/>
<text text-anchor="middle" x="543.5" y="-346.66" font-family="Arial" font-size="10.00">Subscription</text>
<text text-anchor="middle" x="543.5" y="-334.66" font-family="Arial" font-size="10.00">Check</text>
</g>
<!-- data&#45;&gt;subscription_check -->
<g id="edge15" class="edge">
<title>data&#45;&gt;subscription_check</title>
<path fill="none" stroke="black" d="M460.03,-277.64C470.53,-288.76 484.61,-302.89 498.25,-314.16 500.38,-315.92 502.61,-317.68 504.89,-319.4"/>
<polygon fill="black" stroke="black" points="502.46,-321.96 512.6,-325 506.57,-316.3 502.46,-321.96"/>
</g>
<!-- mta_conn_log_tbl -->
<g id="node8" class="node">
<title>mta_conn_log_tbl</title>
<polygon fill="none" stroke="black" points="814,-176.16 814,-268.16 917,-268.16 917,-176.16 814,-176.16"/>
<text text-anchor="middle" x="865.5" y="-254.66" font-family="Arial" font-size="10.00">mta_connection_log</text>
<text text-anchor="middle" x="865.5" y="-242.66" font-family="Arial" font-size="10.00">• id (PK)</text>
<text text-anchor="middle" x="865.5" y="-230.66" font-family="Arial" font-size="10.00">• client_ip</text>
<text text-anchor="middle" x="865.5" y="-218.66" font-family="Arial" font-size="10.00">• stage</text>
<text text-anchor="middle" x="865.5" y="-206.66" font-family="Arial" font-size="10.00">• action</text>
<text text-anchor="middle" x="865.5" y="-194.66" font-family="Arial" font-size="10.00">• timestamp</text>
<text text-anchor="middle" x="865.5" y="-182.66" font-family="Arial" font-size="10.00">• details</text>
</g>
<!-- auth&#45;&gt;mta_conn_log_tbl -->
<g id="edge20" class="edge">
<title>auth&#45;&gt;mta_conn_log_tbl</title>
<path fill="none" stroke="blue" d="M543.66,-240.76C542.71,-195.03 547.42,-76.14 617.75,-24.41 659.46,6.27 695.32,9.72 734.25,-24.41 747.02,-35.61 735.96,-85.34 744.25,-100.16 758.71,-126.01 778.43,-118.31 796,-142.16 803.1,-151.8 799.26,-157.27 806,-167.16 806.29,-167.59 806.59,-168.03 806.89,-168.46"/>
<polygon fill="blue" stroke="blue" points="803.93,-170.34 812.81,-176.13 809.48,-166.07 803.93,-170.34"/>
<text text-anchor="middle" x="672" y="-26.56" font-family="Arial" font-size="8.00">log auth</text>
</g>
<!-- blocked_ips_tbl -->
<g id="node7" class="node">
<title>blocked_ips_tbl</title>
<polygon fill="none" stroke="black" points="830.5,-287.16 830.5,-355.16 900.5,-355.16 900.5,-287.16 830.5,-287.16"/>
<text text-anchor="middle" x="865.5" y="-341.66" font-family="Arial" font-size="10.00">blocked_ips</text>
<text text-anchor="middle" x="865.5" y="-329.66" font-family="Arial" font-size="10.00">• ip (PK)</text>
<text text-anchor="middle" x="865.5" y="-317.66" font-family="Arial" font-size="10.00">• reason</text>
<text text-anchor="middle" x="865.5" y="-305.66" font-family="Arial" font-size="10.00">• blocked_at</text>
<text text-anchor="middle" x="865.5" y="-293.66" font-family="Arial" font-size="10.00">• active</text>
</g>
<!-- mta_msg_log_tbl -->
<g id="node9" class="node">
<title>mta_msg_log_tbl</title>
<polygon fill="none" stroke="black" points="817.75,-374.16 817.75,-502.16 913.25,-502.16 913.25,-374.16 817.75,-374.16"/>
<text text-anchor="middle" x="865.5" y="-488.66" font-family="Arial" font-size="10.00">mta_message_log</text>
<text text-anchor="middle" x="865.5" y="-476.66" font-family="Arial" font-size="10.00">• id (PK)</text>
<text text-anchor="middle" x="865.5" y="-464.66" font-family="Arial" font-size="10.00">• from_address</text>
<text text-anchor="middle" x="865.5" y="-452.66" font-family="Arial" font-size="10.00">• to_addresses</text>
<text text-anchor="middle" x="865.5" y="-440.66" font-family="Arial" font-size="10.00">• subject</text>
<text text-anchor="middle" x="865.5" y="-428.66" font-family="Arial" font-size="10.00">• message_size</text>
<text text-anchor="middle" x="865.5" y="-416.66" font-family="Arial" font-size="10.00">• stage</text>
<text text-anchor="middle" x="865.5" y="-404.66" font-family="Arial" font-size="10.00">• action</text>
<text text-anchor="middle" x="865.5" y="-392.66" font-family="Arial" font-size="10.00">• timestamp</text>
<text text-anchor="middle" x="865.5" y="-380.66" font-family="Arial" font-size="10.00">• queue_id</text>
</g>
<!-- categories_tbl -->
<g id="node10" class="node">
<title>categories_tbl</title>
<polygon fill="none" stroke="black" points="1013,-77.16 1013,-157.16 1119,-157.16 1119,-77.16 1013,-77.16"/>
<text text-anchor="middle" x="1066" y="-143.66" font-family="Arial" font-size="10.00">message_categories</text>
<text text-anchor="middle" x="1066" y="-131.66" font-family="Arial" font-size="10.00">• id (PK)</text>
<text text-anchor="middle" x="1066" y="-119.66" font-family="Arial" font-size="10.00">• name</text>
<text text-anchor="middle" x="1066" y="-107.66" font-family="Arial" font-size="10.00">• email_address</text>
<text text-anchor="middle" x="1066" y="-95.66" font-family="Arial" font-size="10.00">• description</text>
<text text-anchor="middle" x="1066" y="-83.66" font-family="Arial" font-size="10.00">• active</text>
</g>
<!-- subscriptions_tbl -->
<g id="node11" class="node">
<title>subscriptions_tbl</title>
<polygon fill="none" stroke="black" points="817.38,-77.16 817.38,-157.16 913.62,-157.16 913.62,-77.16 817.38,-77.16"/>
<text text-anchor="middle" x="865.5" y="-143.66" font-family="Arial" font-size="10.00">subscriptions</text>
<text text-anchor="middle" x="865.5" y="-131.66" font-family="Arial" font-size="10.00">• id (PK)</text>
<text text-anchor="middle" x="865.5" y="-119.66" font-family="Arial" font-size="10.00">• subscriber_email</text>
<text text-anchor="middle" x="865.5" y="-107.66" font-family="Arial" font-size="10.00">• category_id (FK)</text>
<text text-anchor="middle" x="865.5" y="-95.66" font-family="Arial" font-size="10.00">• subscribed_at</text>
<text text-anchor="middle" x="865.5" y="-83.66" font-family="Arial" font-size="10.00">• active</text>
</g>
<!-- subscriptions_tbl&#45;&gt;categories_tbl -->
<g id="edge21" class="edge">
<title>subscriptions_tbl&#45;&gt;categories_tbl</title>
<path fill="none" stroke="purple" stroke-width="2" d="M914.05,-117.16C940.15,-117.16 972.89,-117.16 1001.19,-117.16"/>
<polygon fill="purple" stroke="purple" stroke-width="2" points="999.58,-120.66 1009.58,-117.16 999.58,-113.66 999.58,-120.66"/>
<text text-anchor="middle" x="965" y="-119.31" font-family="Arial" font-size="8.00">category_id → id</text>
</g>
<!-- ip_check&#45;&gt;blocked_ips_tbl -->
<g id="edge7" class="edge">
<title>ip_check&#45;&gt;blocked_ips_tbl</title>
<path fill="none" stroke="red" d="M571.77,-487.92C574.99,-485.19 578.07,-482.24 580.75,-479.16 603.25,-453.26 591.47,-433.47 617.75,-411.41 681.79,-357.64 718.01,-381.35 796,-351.16 803.74,-348.17 811.89,-344.79 819.76,-341.42"/>
<polygon fill="red" stroke="red" points="821.08,-344.66 828.86,-337.46 818.29,-338.24 821.08,-344.66"/>
<text text-anchor="middle" x="672" y="-413.56" font-family="Arial" font-size="8.00">lookup</text>
</g>
<!-- ip_check&#45;&gt;mta_conn_log_tbl -->
<g id="edge8" class="edge">
<title>ip_check&#45;&gt;mta_conn_log_tbl</title>
<path fill="none" stroke="blue" d="M573.14,-487.78C575.98,-485.13 578.6,-482.25 580.75,-479.16 614.05,-431.36 576.71,-394.76 617.75,-353.41 655.85,-315.01 685.89,-342.4 734.25,-318.16 758.75,-305.89 783.5,-289.02 804.74,-272.85"/>
<polygon fill="blue" stroke="blue" points="806.66,-275.8 812.42,-266.91 802.37,-270.26 806.66,-275.8"/>
<text text-anchor="middle" x="672" y="-355.56" font-family="Arial" font-size="8.00">log result</text>
</g>
<!-- reject -->
<g id="node18" class="node">
<title>reject</title>
<ellipse fill="none" stroke="red" cx="865.5" cy="-569.16" rx="33.52" ry="18"/>
<text text-anchor="middle" x="865.5" y="-565.66" font-family="Arial" font-size="10.00">REJECT</text>
</g>
<!-- ip_check&#45;&gt;reject -->
<g id="edge24" class="edge">
<title>ip_check&#45;&gt;reject</title>
<path fill="none" stroke="red" d="M570.24,-487.77C573.84,-484.97 577.44,-482.05 580.75,-479.16 598.45,-463.71 596.09,-450.51 617.75,-441.41 665.49,-421.36 688.06,-418.02 734.25,-441.41 782.33,-465.76 764.98,-504.21 806,-539.16 812.45,-544.66 820.08,-549.49 827.66,-553.58"/>
<polygon fill="red" stroke="red" points="826,-556.66 836.51,-558.01 829.13,-550.4 826,-556.66"/>
<text text-anchor="middle" x="672" y="-443.56" font-family="Arial" font-size="8.00">blocked IP</text>
</g>
<!-- email_validation&#45;&gt;mta_conn_log_tbl -->
<g id="edge10" class="edge">
<title>email_validation&#45;&gt;mta_conn_log_tbl</title>
<path fill="none" stroke="blue" d="M573.47,-433.99C576.25,-431.31 578.76,-428.36 580.75,-425.16 617.57,-365.8 565.05,-318.26 617.75,-272.41 644.82,-248.86 738.62,-234.85 802.45,-227.83"/>
<polygon fill="blue" stroke="blue" points="802.52,-231.34 812.1,-226.8 801.78,-224.38 802.52,-231.34"/>
<text text-anchor="middle" x="672" y="-274.56" font-family="Arial" font-size="8.00">log result</text>
</g>
<!-- email_validation&#45;&gt;reject -->
<g id="edge25" class="edge">
<title>email_validation&#45;&gt;reject</title>
<path fill="none" stroke="red" d="M573.08,-433.73C575.93,-431.1 578.57,-428.23 580.75,-425.16 612.32,-380.82 573.83,-340.57 617.75,-308.41 659.53,-277.83 691.12,-279.77 734.25,-308.41 793.2,-347.56 777.92,-386.75 796,-455.16 800.8,-473.34 795.27,-523.73 806,-539.16 810.84,-546.12 817.79,-551.56 825.23,-555.79"/>
<polygon fill="red" stroke="red" points="823.63,-558.9 834.15,-560.16 826.71,-552.62 823.63,-558.9"/>
<text text-anchor="middle" x="672" y="-310.56" font-family="Arial" font-size="8.00">invalid format</text>
</g>
<!-- category_check&#45;&gt;mta_conn_log_tbl -->
<g id="edge14" class="edge">
<title>category_check&#45;&gt;mta_conn_log_tbl</title>
<path fill="none" stroke="blue" d="M572.94,-380.76C575.97,-377.89 578.69,-374.68 580.75,-371.16 624.2,-297.04 547.3,-230.6 617.75,-181.41 672.32,-143.32 750,-165.45 803.56,-189.34"/>
<polygon fill="blue" stroke="blue" points="802.01,-192.49 812.56,-193.5 804.94,-186.13 802.01,-192.49"/>
<text text-anchor="middle" x="672" y="-183.56" font-family="Arial" font-size="8.00">log result</text>
</g>
<!-- category_check&#45;&gt;categories_tbl -->
<g id="edge13" class="edge">
<title>category_check&#45;&gt;categories_tbl</title>
<path fill="none" stroke="green" d="M572.69,-381.14C575.84,-378.18 578.66,-374.85 580.75,-371.16 628.37,-287.21 548.39,-224.29 617.75,-157.16 684.25,-92.8 715.7,-88.43 806,-68.16 856.85,-56.75 871.86,-59.53 923.26,-68.16 949.77,-72.61 977.94,-81.44 1002.13,-90.39"/>
<polygon fill="green" stroke="green" points="1000.58,-93.55 1011.17,-93.83 1003.07,-87.01 1000.58,-93.55"/>
<text text-anchor="middle" x="770.12" y="-84.31" font-family="Arial" font-size="8.00">lookup</text>
</g>
<!-- category_check&#45;&gt;reject -->
<g id="edge26" class="edge">
<title>category_check&#45;&gt;reject</title>
<path fill="none" stroke="red" d="M572.95,-380.21C575.89,-377.46 578.59,-374.44 580.75,-371.16 619.66,-312.11 562.24,-260.22 617.75,-216.41 658.4,-184.34 688.79,-191.63 734.25,-216.41 778.71,-240.64 780.63,-263.91 796,-312.16 803.66,-336.22 792.37,-517.91 806,-539.16 810.58,-546.29 817.42,-551.81 824.83,-556.05"/>
<polygon fill="red" stroke="red" points="823.24,-559.18 833.76,-560.41 826.31,-552.88 823.24,-559.18"/>
<text text-anchor="middle" x="672" y="-218.56" font-family="Arial" font-size="8.00">invalid category</text>
</g>
<!-- subscription_check&#45;&gt;categories_tbl -->
<g id="edge17" class="edge">
<title>subscription_check&#45;&gt;categories_tbl</title>
<path fill="none" stroke="green" d="M571.75,-325.99C575.31,-322.48 578.5,-318.52 580.75,-314.16 609.19,-259.2 565.46,-71.25 617.75,-38.16 688.59,6.67 918.97,1.17 995,-34.16 1010.85,-41.53 1024.39,-54.44 1035.23,-67.92"/>
<polygon fill="green" stroke="green" points="1032.22,-69.74 1041.04,-75.6 1037.8,-65.51 1032.22,-69.74"/>
<text text-anchor="middle" x="770.12" y="-10.2" font-family="Arial" font-size="8.00">lookup</text>
</g>
<!-- subscription_check&#45;&gt;subscriptions_tbl -->
<g id="edge16" class="edge">
<title>subscription_check&#45;&gt;subscriptions_tbl</title>
<path fill="none" stroke="green" d="M571.74,-325.99C575.31,-322.47 578.49,-318.51 580.75,-314.16 604.75,-267.86 561.72,-116.89 598.75,-80.16 661.07,-18.35 712.16,-44.16 796,-70.16 799.69,-71.31 803.36,-72.73 806.98,-74.35"/>
<polygon fill="green" stroke="green" points="805.12,-77.34 815.63,-78.74 808.29,-71.1 805.12,-77.34"/>
<text text-anchor="middle" x="672" y="-64.83" font-family="Arial" font-size="8.00">lookup</text>
</g>
<!-- final_decision -->
<g id="node16" class="node">
<title>final_decision</title>
<polygon fill="none" stroke="black" points="672,-524.16 617.75,-492.16 672,-460.16 726.25,-492.16 672,-524.16"/>
<text text-anchor="middle" x="672" y="-494.66" font-family="Arial" font-size="10.00">Final</text>
<text text-anchor="middle" x="672" y="-482.66" font-family="Arial" font-size="10.00">Decision</text>
</g>
<!-- subscription_check&#45;&gt;final_decision -->
<g id="edge18" class="edge">
<title>subscription_check&#45;&gt;final_decision</title>
<path fill="none" stroke="black" d="M572.26,-362.62C575.33,-365.28 578.24,-368.15 580.75,-371.16 604.54,-399.72 595.01,-416.76 617.75,-446.16 623.66,-453.8 631,-461.11 638.32,-467.56"/>
<polygon fill="black" stroke="black" points="635.75,-469.98 645.66,-473.74 640.26,-464.62 635.75,-469.98"/>
</g>
<!-- final_decision&#45;&gt;mta_msg_log_tbl -->
<g id="edge19" class="edge">
<title>final_decision&#45;&gt;mta_msg_log_tbl</title>
<path fill="none" stroke="blue" d="M709.47,-481.88C736.85,-474.16 774.88,-463.43 806.42,-454.54"/>
<polygon fill="blue" stroke="blue" points="807.15,-457.97 815.82,-451.89 805.25,-451.23 807.15,-457.97"/>
<text text-anchor="middle" x="770.12" y="-473.74" font-family="Arial" font-size="8.00">log message</text>
</g>
<!-- accept -->
<g id="node17" class="node">
<title>accept</title>
<ellipse fill="none" stroke="green" cx="865.5" cy="-677.16" rx="34.43" ry="18"/>
<text text-anchor="middle" x="865.5" y="-673.66" font-family="Arial" font-size="10.00">ACCEPT</text>
</g>
<!-- final_decision&#45;&gt;accept -->
<g id="edge22" class="edge">
<title>final_decision&#45;&gt;accept</title>
<path fill="none" stroke="green" d="M685.64,-516.53C698.5,-539.98 719.95,-575.67 744.25,-602.16 767.75,-627.78 776.3,-632.09 806,-650.16 812.68,-654.22 820.07,-658.08 827.28,-661.54"/>
<polygon fill="green" stroke="green" points="825.71,-664.67 836.26,-665.67 828.64,-658.31 825.71,-664.67"/>
<text text-anchor="middle" x="770.12" y="-645.44" font-family="Arial" font-size="8.00">subscribed</text>
</g>
<!-- quarantine -->
<g id="node19" class="node">
<title>quarantine</title>
<ellipse fill="none" stroke="orange" cx="865.5" cy="-623.16" rx="49.76" ry="18"/>
<text text-anchor="middle" x="865.5" y="-619.66" font-family="Arial" font-size="10.00">QUARANTINE</text>
</g>
<!-- final_decision&#45;&gt;quarantine -->
<g id="edge23" class="edge">
<title>final_decision&#45;&gt;quarantine</title>
<path fill="none" stroke="orange" d="M694.44,-511.49C719.82,-533.73 763.97,-570.51 806,-596.16 810.89,-599.15 816.16,-602.01 821.47,-604.7"/>
<polygon fill="orange" stroke="orange" points="819.73,-607.75 830.26,-608.95 822.78,-601.44 819.73,-607.75"/>
<text text-anchor="middle" x="770.12" y="-591.02" font-family="Arial" font-size="8.00">not subscribed</text>
</g>
</g>
</svg>
